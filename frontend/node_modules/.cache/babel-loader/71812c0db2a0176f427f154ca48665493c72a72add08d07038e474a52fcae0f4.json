{"ast":null,"code":"// Speech Recognition Setup\nlet recognition;\nlet isListening = false;\nlet onResultCallback = null;\nif ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {\n  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n  recognition = new SpeechRecognition();\n  recognition.continuous = true;\n  recognition.interimResults = false;\n  recognition.lang = 'en-US';\n} else {\n  console.error('Speech Recognition not supported');\n}\n\n// TTS Setup\nconst speak = (text, onEnd = () => {}) => {\n  const utterance = new window.SpeechSynthesisUtterance(text);\n  utterance.onend = onEnd;\n  window.speechSynthesis.speak(utterance);\n};\nconst startListening = onResult => {\n  if (!recognition) return;\n  onResultCallback = onResult;\n  recognition.onresult = event => {\n    const command = event.results[event.results.length - 1][0].transcript.toLowerCase().trim();\n    if (onResultCallback) onResultCallback(command);\n  };\n  recognition.onend = () => {\n    isListening = false;\n    // Restart listening automatically for continuous recognition\n    try {\n      recognition.start();\n      isListening = true;\n    } catch (e) {\n      // Sometimes start() throws if called too quickly, so wait and retry\n      setTimeout(() => {\n        try {\n          recognition.start();\n          isListening = true;\n        } catch (err) {}\n      }, 500);\n    }\n  };\n  recognition.onerror = e => {\n    isListening = false;\n    // Restart on error except for not-allowed errors\n    if (e.error !== 'not-allowed') {\n      setTimeout(() => {\n        try {\n          recognition.start();\n          isListening = true;\n        } catch (err) {}\n      }, 500);\n    }\n  };\n  if (!isListening) {\n    try {\n      recognition.start();\n      isListening = true;\n    } catch (e) {}\n  }\n};\nconst stopListening = () => {\n  if (recognition && isListening) {\n    recognition.stop();\n    isListening = false;\n  }\n};\nexport { speak, startListening, stopListening };","map":{"version":3,"names":["recognition","isListening","onResultCallback","window","SpeechRecognition","webkitSpeechRecognition","continuous","interimResults","lang","console","error","speak","text","onEnd","utterance","SpeechSynthesisUtterance","onend","speechSynthesis","startListening","onResult","onresult","event","command","results","length","transcript","toLowerCase","trim","start","e","setTimeout","err","onerror","stopListening","stop"],"sources":["C:/Users/KIIT0001/Desktop/Accessible-Learning-Platform-for-Visually-Impaired/frontend/src/utils/voiceUtils.js"],"sourcesContent":["// Speech Recognition Setup\r\nlet recognition;\r\nlet isListening = false;\r\nlet onResultCallback = null;\r\n\r\nif ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {\r\n  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\r\n  recognition = new SpeechRecognition();\r\n  recognition.continuous = true;\r\n  recognition.interimResults = false;\r\n  recognition.lang = 'en-US';\r\n} else {\r\n  console.error('Speech Recognition not supported');\r\n}\r\n\r\n// TTS Setup\r\nconst speak = (text, onEnd = () => {}) => {\r\n  const utterance = new window.SpeechSynthesisUtterance(text);\r\n  utterance.onend = onEnd;\r\n  window.speechSynthesis.speak(utterance);\r\n};\r\n\r\nconst startListening = (onResult) => {\r\n  if (!recognition) return;\r\n  onResultCallback = onResult;\r\n\r\n  recognition.onresult = (event) => {\r\n    const command = event.results[event.results.length - 1][0].transcript.toLowerCase().trim();\r\n    if (onResultCallback) onResultCallback(command);\r\n  };\r\n\r\n  recognition.onend = () => {\r\n    isListening = false;\r\n    // Restart listening automatically for continuous recognition\r\n    try {\r\n      recognition.start();\r\n      isListening = true;\r\n    } catch (e) {\r\n      // Sometimes start() throws if called too quickly, so wait and retry\r\n      setTimeout(() => {\r\n        try {\r\n          recognition.start();\r\n          isListening = true;\r\n        } catch (err) {}\r\n      }, 500);\r\n    }\r\n  };\r\n\r\n  recognition.onerror = (e) => {\r\n    isListening = false;\r\n    // Restart on error except for not-allowed errors\r\n    if (e.error !== 'not-allowed') {\r\n      setTimeout(() => {\r\n        try {\r\n          recognition.start();\r\n          isListening = true;\r\n        } catch (err) {}\r\n      }, 500);\r\n    }\r\n  };\r\n\r\n  if (!isListening) {\r\n    try {\r\n      recognition.start();\r\n      isListening = true;\r\n    } catch (e) {}\r\n  }\r\n};\r\n\r\nconst stopListening = () => {\r\n  if (recognition && isListening) {\r\n    recognition.stop();\r\n    isListening = false;\r\n  }\r\n};\r\n\r\nexport { speak, startListening, stopListening };"],"mappings":"AAAA;AACA,IAAIA,WAAW;AACf,IAAIC,WAAW,GAAG,KAAK;AACvB,IAAIC,gBAAgB,GAAG,IAAI;AAE3B,IAAI,mBAAmB,IAAIC,MAAM,IAAI,yBAAyB,IAAIA,MAAM,EAAE;EACxE,MAAMC,iBAAiB,GAAGD,MAAM,CAACC,iBAAiB,IAAID,MAAM,CAACE,uBAAuB;EACpFL,WAAW,GAAG,IAAII,iBAAiB,CAAC,CAAC;EACrCJ,WAAW,CAACM,UAAU,GAAG,IAAI;EAC7BN,WAAW,CAACO,cAAc,GAAG,KAAK;EAClCP,WAAW,CAACQ,IAAI,GAAG,OAAO;AAC5B,CAAC,MAAM;EACLC,OAAO,CAACC,KAAK,CAAC,kCAAkC,CAAC;AACnD;;AAEA;AACA,MAAMC,KAAK,GAAGA,CAACC,IAAI,EAAEC,KAAK,GAAGA,CAAA,KAAM,CAAC,CAAC,KAAK;EACxC,MAAMC,SAAS,GAAG,IAAIX,MAAM,CAACY,wBAAwB,CAACH,IAAI,CAAC;EAC3DE,SAAS,CAACE,KAAK,GAAGH,KAAK;EACvBV,MAAM,CAACc,eAAe,CAACN,KAAK,CAACG,SAAS,CAAC;AACzC,CAAC;AAED,MAAMI,cAAc,GAAIC,QAAQ,IAAK;EACnC,IAAI,CAACnB,WAAW,EAAE;EAClBE,gBAAgB,GAAGiB,QAAQ;EAE3BnB,WAAW,CAACoB,QAAQ,GAAIC,KAAK,IAAK;IAChC,MAAMC,OAAO,GAAGD,KAAK,CAACE,OAAO,CAACF,KAAK,CAACE,OAAO,CAACC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAACC,UAAU,CAACC,WAAW,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;IAC1F,IAAIzB,gBAAgB,EAAEA,gBAAgB,CAACoB,OAAO,CAAC;EACjD,CAAC;EAEDtB,WAAW,CAACgB,KAAK,GAAG,MAAM;IACxBf,WAAW,GAAG,KAAK;IACnB;IACA,IAAI;MACFD,WAAW,CAAC4B,KAAK,CAAC,CAAC;MACnB3B,WAAW,GAAG,IAAI;IACpB,CAAC,CAAC,OAAO4B,CAAC,EAAE;MACV;MACAC,UAAU,CAAC,MAAM;QACf,IAAI;UACF9B,WAAW,CAAC4B,KAAK,CAAC,CAAC;UACnB3B,WAAW,GAAG,IAAI;QACpB,CAAC,CAAC,OAAO8B,GAAG,EAAE,CAAC;MACjB,CAAC,EAAE,GAAG,CAAC;IACT;EACF,CAAC;EAED/B,WAAW,CAACgC,OAAO,GAAIH,CAAC,IAAK;IAC3B5B,WAAW,GAAG,KAAK;IACnB;IACA,IAAI4B,CAAC,CAACnB,KAAK,KAAK,aAAa,EAAE;MAC7BoB,UAAU,CAAC,MAAM;QACf,IAAI;UACF9B,WAAW,CAAC4B,KAAK,CAAC,CAAC;UACnB3B,WAAW,GAAG,IAAI;QACpB,CAAC,CAAC,OAAO8B,GAAG,EAAE,CAAC;MACjB,CAAC,EAAE,GAAG,CAAC;IACT;EACF,CAAC;EAED,IAAI,CAAC9B,WAAW,EAAE;IAChB,IAAI;MACFD,WAAW,CAAC4B,KAAK,CAAC,CAAC;MACnB3B,WAAW,GAAG,IAAI;IACpB,CAAC,CAAC,OAAO4B,CAAC,EAAE,CAAC;EACf;AACF,CAAC;AAED,MAAMI,aAAa,GAAGA,CAAA,KAAM;EAC1B,IAAIjC,WAAW,IAAIC,WAAW,EAAE;IAC9BD,WAAW,CAACkC,IAAI,CAAC,CAAC;IAClBjC,WAAW,GAAG,KAAK;EACrB;AACF,CAAC;AAED,SAASU,KAAK,EAAEO,cAAc,EAAEe,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}